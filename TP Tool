-- TP TOOL - GUI SAFE MODE ðŸ˜ŽðŸ”¥
-- Coloque este LocalScript em StarterPlayerScripts

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer

-- Criar Tool
local tool = Instance.new("Tool")
tool.Name = "TP Tool"
tool.RequiresHandle = false
tool.CanBeDropped = false
tool.Parent = player:WaitForChild("Backpack")

-- FunÃ§Ã£o de Teleporte
local function TeleportTo(position)
	local character = player.Character
	if not character then return end

	local root = character:FindFirstChild("HumanoidRootPart")
	if root then
		root.CFrame = CFrame.new(position + Vector3.new(0, 5, 0))
	end
end

-- Verifica se o clique foi em um GUI
local function ClickedOnGui()
	local guiObjects = player.PlayerGui:GetDescendants()

	for _, obj in ipairs(guiObjects) do
		if obj:IsA("GuiObject") and obj.Visible then
			-- Se o objeto estiver sob o ponteiro, Ã© GUI
			if obj:IsA("TextButton") or obj:IsA("ImageButton") or obj.Active then
				local mousePos = UserInputService:GetMouseLocation()
				if obj.AbsolutePosition
					and mousePos.X >= obj.AbsolutePosition.X
					and mousePos.X <= obj.AbsolutePosition.X + obj.AbsoluteSize.X
					and mousePos.Y >= obj.AbsolutePosition.Y
					and mousePos.Y <= obj.AbsolutePosition.Y + obj.AbsoluteSize.Y then
					return true
				end
			end
		end
	end

	return false
end

-- PC: Teleportar ao clicar
tool.Activated:Connect(function()
	-- Bloqueia se clicar em GUI
	if ClickedOnGui() then return end

	local mouse = player:GetMouse()
	local targetPos = mouse.Hit and mouse.Hit.p

	if targetPos then
		TeleportTo(targetPos)
	end
end)

-- MOBILE: Teleportar ao tocar
UserInputService.TouchTap:Connect(function(touchPosTbl)
	-- Tool precisa estar equipada
	if not tool.Parent or tool.Parent ~= player.Character then return end

	-- Se tocou em GUI â†’ bloquear
	if ClickedOnGui() then return end

	local pos = touchPosTbl[1]
	local camera = workspace.CurrentCamera

	local ray = camera:ScreenPointToRay(pos.X, pos.Y)
	local raycastParams = RaycastParams.new()
	raycastParams.FilterDescendantsInstances = {player.Character}
	raycastParams.FilterType = Enum.RaycastFilterType.Blacklist

	local result = workspace:Raycast(ray.Origin, ray.Direction * 1000, raycastParams)

	if result then
		TeleportTo(result.Position)
	end
end)
